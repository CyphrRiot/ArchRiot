general {
    lock_cmd = /usr/bin/hyprlock                   # execute directly; hypridle does not interpret shell operators
    before_sleep_cmd = /usr/bin/loginctl lock-session    # lock before suspend.
    after_sleep_cmd = /usr/bin/hyprctl dispatch dpms on  # to avoid having to press a key twice to turn on the display.
}

# Gentle brightness dim (no DPMS; safe for AMD/Intel)
listener {
    timeout = 300                                 # 5min
    on-timeout = /usr/bin/bash -lc '[ -x /usr/bin/brightnessctl ] && /usr/bin/brightnessctl -q -s set 20%'
    on-resume  = /usr/bin/bash -lc '[ -x /usr/bin/brightnessctl ] && /usr/bin/brightnessctl -q -r'
}

listener {
    timeout = 600                      # 10min
    on-timeout = /usr/bin/hyprlock
}

# Idle suspend only when undocked and on battery (guarded by suspend-if-undocked.sh)
listener {
    timeout = 3600                      # 60 min
    on-timeout = /usr/bin/bash -lc '~/.local/bin/suspend-if-undocked.sh'
}
